var spJson = '[{"t":"上门约炮，穴痒，水都流出来了！","c":"上门约炮，穴痒，水都流出来了！","l":"sku145.com","u":"https:\/\/sku145.com\/"},{"t":"附近约爱，上门服务，凤美价廉！","c":"附近约爱，上门服务，凤美价廉！","l":"dak540.com","u":"https:\/\/dak540.com\/"},{"t":"澳门皇冠赌场 6650.com","c":"澳门皇冠赌场24小时AV女忧在线发牌，真人百家乐，龙虎斗，牛牛，AV捕鱼王，上万款老虎机游戏。百万提款3分钟火速到账,每日千亿红包雨疯狂抢不停；天天返水1.5%无上限","l":"6650.com","u":"https:\/\/www.ludu319.com\/jiba123.htm"},{"t":"[凤凰娱乐 1156.COM] 十年凤凰 一如既往！","c":"老品牌,值得信赖！1元即可存取款,美女荷官在线发牌，百家乐，牛牛，AV捕鱼王，上万款老虎机游戏任你玩。下载APP送18元，赢到100可以直接提现。","l":"FHYL.COM","u":"https:\/\/www.huntermailfocus.com\/feng88.htm"},{"t":"澳门新葡京","c":"风靡全国顶级棋牌博彩平台随心所欲随时随地畅玩","l":"2260.vip","u":"https:\/\/www.075577777.com\/ag02\/"},{"t":"澳门皇冠赌场 6650.com","c":"澳门皇冠赌场24小时AV女忧在线发牌，真人百家乐，龙虎斗，牛牛，AV捕鱼王，上万款老虎机游戏。百万提款3分钟火速到账,每日千亿红包雨疯狂抢不停；天天返水1.5%无上限","l":"6650.com","u":"https:\/\/www.ludu319.com\/jiba123.htm"},{"t":"[凤凰娱乐 1156.COM] 十年凤凰 一如既往！","c":"老品牌,值得信赖！1元即可存取款,美女荷官在线发牌，百家乐，牛牛，AV捕鱼王，上万款老虎机游戏任你玩。下载APP送18元，赢到100可以直接提现。","l":"FHYL.COM","u":"https:\/\/www.huntermailfocus.com\/feng88.htm"},{"t":"澳门新葡京","c":"风靡全国顶级棋牌博彩平台随心所欲随时随地畅玩","l":"2260.vip","u":"https:\/\/www.075577777.com\/ag02\/"},{"t":"澳门皇冠赌场 6650.com","c":"澳门皇冠赌场24小时AV女忧在线发牌，真人百家乐，龙虎斗，牛牛，AV捕鱼王，上万款老虎机游戏。百万提款3分钟火速到账,每日千亿红包雨疯狂抢不停；天天返水1.5%无上限","l":"6650.com","u":"https:\/\/www.lul8.com\/jiba123.htm"},{"t":"澳门银河","c":"官方直营 值得信赖 全网独家 百万真实玩家火热在线PK 全民顶级竞技 资金安全保障 游戏畅通无阻 款项极速到账 优质客服在线","l":"8817.vip","u":"https:\/\/hnhflqgc.com\/caoliu"},{"t":"澳门银河","c":"官方直营 值得信赖 全网独家 百万真实玩家火热在线PK 全民顶级竞技 资金安全保障 游戏畅通无阻 款项极速到账 优质客服在线","l":"8817.vip","u":"https:\/\/hnhflqgc.com\/caoliu"},{"t":"澳门银河","c":"官方直营 值得信赖 全网独家 百万真实玩家火热在线PK 全民顶级竞技 资金安全保障 游戏畅通无阻 款项极速到账 优质客服在线","l":"8817.vip","u":"https:\/\/hnhflqgc.com\/caoliu"},{"t":"鸿博体育","c":"2022年世界杯 官方指定投注平台 注册送588元 全球最专业的体育平台 滚球高赔率 鸿博体育 鸿运当头 博必发 每日一博，见好就收","l":"hongbo.com","u":"https:\/\/www.beiren.cc\/caoliu"},{"t":"凤凰棋牌","c":"棋牌娱乐 首选凤凰","l":"3376.cc","u":"https:\/\/www.cgkjvip.com\/fhgg2.html"},{"t":"必赢棋牌","c":"必赢棋牌 逢赌必赢","l":"6559.com","u":"https:\/\/www.cgkjvip.com\/bygg26.htm"},{"t":"磁力狗","c":"全球资源最丰富的磁力链BT种子搜索下载网站和垂直搜索引擎","l":"magnetdog.net","u":"https:\/\/clgoes.com\/"},{"t":"廣告投放","c":"請聯繫我們：yuuwill@hotmail.com","l":"在此展示您的廣告","u":"\/faq.php?faqjob=ads"},{"t":"色友推荐 [王者棋牌8896.com]","c":"全球顶级竞技中心 ，王者棋牌唯一指定官网。全网最齐全的棋牌游戏APP，提款最快，3分钟火速到账。玩王者棋牌，人人做王者。","l":"8896.com","u":"https:\/\/www.361dai.com\/daili08.htm"},{"t":"小姐上门-同城约炮","c":"兼职小姐，全国上门服务小姐上门，全国空降，学生少妇，应有尽有，立即预约","l":"ovx439.com","u":"https:\/\/ovx439.com"},{"t":"大發娱乐 6117.net","c":"大發集团，官网直营，大额无忧，存款送3%注册送888元，赢钱秒到账！百家乐，龙虎斗，炸金花 ，捕鱼 热门游戏应有尽有","l":"6117.net","u":"https:\/\/hikwufh.perchart.net\/dec125b\/b0687a.html?shareName=caoliu"},{"t":"鸿运棋牌 9982.com","c":"为荣耀而战［鸿运棋牌等你来］","l":"9982.com","u":"https:\/\/www.ydjdcjc.com\/caoliu88.htm"},{"t":"开元棋牌 3359.com","c":"［KY开元棋牌］老品牌值得信赖","l":"3359.com","u":"https:\/\/www.zhengxingw.com\/caoliu88.htm"},{"t":"优选美女上门","c":"会爱精选，小姐上门，干到舒爽。","l":"ovx439.com","u":"https:\/\/ovx439.com"},{"t":"招嫖私人定制","c":"同城约骚女，少妇，熟女，十分钟上门服务","l":"ovx439.com","u":"https:\/\/ovx439.com"},{"t":"全国同城 约炮大群 空降约炮","c":"加人约炮大群同城免费约炮私房速约白领少妇模特学生","l":"ovx439.com","u":"https:\/\/ovx439.com"},{"t":"[开元棋牌] 9188.net","c":"开元棋牌,棋牌手游第一品牌,美女对战火热PK, [下载APP注册送188元，赢钱秒提现！]","l":"9188.net","u":"https:\/\/hikwufh.perchart.net\/7ddec87\/8beee.html?shareName=caoliu"},{"t":"聚合全网H直播聚合全网H直播","c":"聚合全网H直播聚合全网H直播，全网收费H直播免费看","l":"cxzzcsasa.net:9001\/#\/?uid=53254217","u":"https:\/\/cxzzcsasa.net:9001\/#\/?uid=53254217"},{"t":"真做爱约炮","c":"留学生兼职x疫情可上门真约炮","l":"ovx439.com","u":"https:\/\/ovx439.com"},{"t":"鸿博体育","c":"2022年世界杯 官方指定投注平台 注册送588元 全球最专业的体育平台 滚球高赔率 鸿博体育 鸿运当头 博必发 每日一博，见好就收","l":"hongbo.com","u":"https:\/\/www.beiren.cc\/caoliu"},{"t":"鸿博体育","c":"2022年世界杯 官方指定投注平台 注册送588元 全球最专业的体育平台 滚球高赔率 鸿博体育 鸿运当头 博必发 每日一博，见好就收","l":"hongbo.com","u":"https:\/\/www.beiren.cc\/caoliu"},{"t":"同城上门，专业约炮平台","c":"华人高端约炮平台全国可约，不满意免费换","l":"ovx439.com","u":"https:\/\/ovx439.com"},{"t":"大发娱乐 4888.com","c":"大发娱乐 4888.com","l":"4888.com","u":"https:\/\/www.sjhfkhgut009.com\/caoliu88.htm"},{"t":"怡春院","c":"英雄江湖撕殺 拼搏為了誰  ？終究還是為了插紅顏。想插嗎？","l":"m.av28.tv","u":"https:\/\/m.av28.tv"},{"t":"全国性息酒店监控随时看","c":"全国性息在线下载 酒店家庭监控88台实时观看","l":"post.duduyun.cc:33896","u":"http:\/\/post.duduyun.cc:33896\/"},{"t":"猎奇重口专区","c":"全球猎奇资源：缅北轮奸 老人性交 母狗喝尿 同性人妖 恋物窥视","l":"uncdfx.m2bq671w.xyz\/zktvd-33","u":"https:\/\/uncdfx.m2bq671w.xyz\/zktvd-33"}]';
var spData = JSON.parse(spJson);
var spCount= 0;
var timeOffset = !isNaN(parseInt(getCookie('timezoneOffset'))) ? -parseInt(getCookie('timezoneOffset'))*60*60000 : new Date().getTimezoneOffset()*60000;

function spinit(){
	spRnd = spCount>1 ? Math.floor(Math.random() * spData.length) : 0;
	spInfo= "<div class='sptable_info' onclick='event.stopPropagation();window.open(\"/faq.php?faqjob=ads\")'> AD</div>";
	str   = "<TABLE cellspacing='0' cellpadding='5' width='100%' class='sptable_do_not_remove'><TR>";
	str  += "<TD width='50%' valign='top' onclick=\"clurl('"+spData[spRnd].u+"', "+spCount+")\"><h4>"+spData[spRnd].t+"</h4>"+spData[spRnd].c;
	str  += "<br><a id='srcf"+spCount+"' href='"+spData[spRnd].u+"' target='_blank' onclick='event.stopPropagation();'>"+spData[spRnd].l+"</a></TD>";
	spData.splice(spRnd,1);
	spRnd = spCount>1 ? Math.floor(Math.random() * spData.length) : 0;
	str  += "<TD width='50%' valign='top' onclick=\"clurl('"+spData[spRnd].u+"', "+(spCount+1)+")\"><h4>"+spData[spRnd].t+"</h4>"+spData[spRnd].c;
	str  += "<br><a id='srcf"+(spCount+1)+"' href='"+spData[spRnd].u+"' target='_blank' onclick='event.stopPropagation();'>"+spData[spRnd].l+"</a>"+spInfo+"</TD>";
	document.write(str+"</TR></TABLE>");
	spData.splice(spRnd,1);
	spCount += 2;
}

function setCookie(cname, cvalue, exdays) {
  var d = new Date();
  d.setTime(d.getTime() + (exdays * 24 * 60 * 60 * 1000));
  var expires = "expires="+d.toUTCString();
  document.cookie = cname + "=" + cvalue + ";" + expires + ";path=/";
}

function getCookie(cname) {
  var name = cname + "=";
  var ca = document.cookie.split(';');
  for(var i = 0; i < ca.length; i++) {
    var c = ca[i];
    while (c.charAt(0) == ' ') {
      c = c.substring(1);
    }
    if (c.indexOf(name) == 0) {
      return c.substring(name.length, c.length);
    }
  }
  return "";
}

function cssInit(v){
	var cssName = getCookie('hidebanner')=="1" ? 'style_gray' : 'style';
	document.write("<link rel='stylesheet' href='//2023.redircdn.com/web/"+cssName+".css?v="+v+"' type='text/css' />");
}

var cnt = 0;
function checkpost(obj){
	if(obj.atc_title.value==""){
		tailMsg('標題不能為空', '', 0);
		obj.atc_title.focus();
		return false;
	}else if(strlen(obj.atc_title.value)>300){
		tailMsg('標題超過最大長度 300 個字節', '', 0);
		obj.atc_title.focus();
		return false;
	}
	if(strlen(obj.atc_content.value)<3){
		tailMsg('文章內容少於 3 個字節', '', 0);
		obj.atc_content.focus();
		return false;
	}else if(strlen(obj.atc_content.value)>80000){
		tailMsg('文章內容大於 80000 個字節', '', 0);
		obj.atc_content.focus();
		return false;
	}
	if(obj.action.value=='comment'){
		if(strlen(obj.atc_content.value)>350){
			tailMsg('點評內容限制 350 字節', '', 0);
			obj.atc_content.focus();
			return false;
		}
		if(obj.atc_content.value.indexOf('[/')>0){
			tailMsg('點評不支持 UBB 代碼', '', 0);
			obj.atc_content.focus();
			return false;
		}
	}
	document.FORM.Submit.value='正在提交回覆..';
	cnt++;
	if(cnt!=1){
		tailMsg('正在提交，請稍後', '', 0);
		return false;
	}
	return true;
}
function checklength(theform,postmaxchars){
	var message = postmaxchars != 0 ? '，系統限制：'+postmaxchars+' 字節' : '';
	tailMsg('您的信息已有字節數：'+strlen(theform.atc_content.value)+' 字節'+message, '', 0);
}
function addsmile(NewCode){
    document.FORM.atc_content.value += ' [s:'+NewCode+'] ';
}
ifcheck = true;
function CheckAll(form){
	for(var i=0;i<form.elements.length-12;i++){
		var e = form.elements[i];
		if(e.type=='checkbox') e.checked = ifcheck;
	}
	ifcheck = ifcheck == true ? false : true;
}
function CopyCode(obj){
    var el = document.createElement('textarea');
    el.value = document.getElementById(obj).innerText;
    document.body.appendChild(el);
    el.select();
	if(document.execCommand('copy')){
		tailMsg('已複製', '', 0);
	}else{
		tailMsg('無法複製，請手動複製', '', 0);
	}
    document.body.removeChild(el);
}
function strlen(str){
	var len = 0;
	var c_len = charset == 'utf-8' ? 3 : 2;
	for(var i=0;i<str.length;i++){
		len += str.charCodeAt(i) < 0 || str.charCodeAt(i) > 255 ? c_len : 1;
	}
	return len;
}
function postreply(txt, pid, touID, contID){
	if(typeof document.FORM != "undefined"){
		document.FORM.action.value = 'comment';
		document.FORM.article.value = $('#like'+pid).attr('article');;
		document.FORM.pid.value = pid;
		document.FORM.touid.value = touID;
		document.FORM.atc_title.value = txt;
		if(typeof contID=='undefined'){
			$('.quote_text').hide();
		}else{
			$('.quote_text').html( $('#'+contID).html() );
			$('.quote_text').show();
		}
		document.FORM.atc_content.focus();
	}
}
function resetform(obj, action){
	$('.quote_text').hide();
	obj.action.value = action;
	obj.reset();
}
function quickpost(event){
	if((event.ctrlKey && event.keyCode == 13) || (event.altKey && event.keyCode == 83)){
		document.FORM.Submit.click();
	}
}

function tidToUrl(obj,tid,fid,date){
	url = fid=="9" ? '/read.php?tid='+tid : '/htm_data/'+date+'/'+fid+'/'+tid+'.html';
	obj.href = "//"+window.location.hostname + url;
}

if(window.location.href.indexOf('private')>0 && !/(post)\.php/i.test(window.location.href)){
	document.body.innerHTML = "";
	window.location.href = "http://www.godaddy.com";
}

function checkBigImage(obj){
	var b = obj.prop("naturalWidth")>obj.width();
	var l = obj.attr('data-link');
	if(b || l){
		var s = b ? ' style="font-size:18px;padding:7px 10px;"' : '';
		var t = b ? '尺寸: '+obj.prop("naturalWidth")+'x'+obj.prop("naturalHeight") : '';
		t    += l ? (t ? '&#10;' : '')+'链接: '+obj.attr('data-link') : '';
		var i = b ? '<a href="javascript:widthToggle()" class="swhite">高清</a>' : '';
		i    += l ? (i ? ' | ' : '')+'链接' : '';
		obj.wrap('<div class="image-big"></div>');
		obj.after('<div class="image-big-text" title="'+t+'"'+s+'>'+i+'</div>');
	}
}

function widthToggle(){
	var main = $("#main"), header = $("#header");
	if(main.css("max-width")=="1288px"){
		main.css("max-width", "100%");
		header.css("max-width", "100%");
	}else{
		main.css("max-width", "1288px");
		header.css("max-width", "1288px");
	}
}

function fontsizeToggle(){
	var contDiv = $(".tpc_content:eq(0)");
	var isChrome = !!window.chrome && (!!window.chrome.webstore || !!window.chrome.runtime);
	if(isChrome){
		if(contDiv.css("zoom")=="2"){
			contDiv.css("zoom", "1");
		}else{
			contDiv.css("zoom", parseFloat(contDiv.css("zoom"))+0.2);
		}
	}else{
		if(contDiv.css("font-size")=="24px"){
			contDiv.css("font-size", "14px");
		}else{
			contDiv.css("font-size", (parseFloat(contDiv.css("font-size"))+2)+'px');
		}
	}
}

function clurl(url, id){
	if(url=='test'){
		return 'dfe3s';
	}else{
		/*if(!getCookie('testBlock')){
			setCookie('testBlock', 1, 365)
			var w = window.open(url);
			setTimeout(function(){
				if(w.closed){
					alert('您的去广告插件已破坏本页内容，请关闭广告插件后，点击任意一个广告即可恢复浏览');
					setCookie('testKhse', 1, 365)
				}
			}, 100);
		}*/
		var w = window.open(url);
		setTimeout(function(){
			if(w.closed){
				$('#srcf'+id).text($('#srcf'+id).attr('href'));
				$('#srcf'+id).after(' <span style="color:red">←右键复制此网址在新窗口中打开，即可安全访问</span>');
			}
		}, 100);
	}
}

function clickLike(id, page, type){
	var path   = page=='h' ? '../../../' : '';
	var obj    = $("#like"+id);
	var objHtml= obj.html();
	obj.css('pointer-events', 'none');
	obj.html('赞(...)');
	$.post(path+'api.php', { 'action': 'clickLike', 'id': id, 'page': page, 'type': type, 'json': 1, 'url': window.location.href }, function (data){
		if(data.cont.indexOf('Limited30')>0){
			obj.html('每天只能贊30次，請明天再來吧');
			setTimeout(function(){ obj.html(objHtml) }, 21000);
		}else{
			if(type!='t') obj.addClass('s3');
			if(data.money>=0){
				var myText = data.myMoney>0 ? '<hr>每日首赞奖励 您的金钱+' + data.myMoney : '';
				obj.html('赞('+data.count+')');
				tailMsg('赞+1' + (data.money>0 ? ' 金钱+'+data.money : '') + myText, obj, 0);
			}else{
				obj.html(data.cont);
			}
		}
		setTimeout(function(){
			obj.css('pointer-events', '');
		}, 20000);
	}, "json").fail(function() {
		tailMsg('點贊太快或數據出錯，請重試', obj, 0);
		obj.html(objHtml).css('pointer-events', '');
	});
}

function tailMsg(msg, obj, offset){
	var tail = $("#tail_msg");
	if( tail.length==0 ){
		tail = $('<div>', {id: 'tail_msg'}).appendTo('body');
	}
	tail.removeClass().attr('style','').html(msg);
	if(typeof obj == 'string'){
		tail.addClass('tail_toast');
	}else{
		tail.addClass('tail_msg');
		tail.css({
			'left': obj.offset().left + ((obj.outerWidth() - tail.outerWidth())/2),
			 'top': obj.offset().top + obj.outerHeight() + (offset!=0 ? offset : 10)
		});
	}
	tail.stop().fadeIn("fast").delay(msg.indexOf('<hr>')>0 ? 20000 : 3000).fadeOut("slow");
}

function loadMoreComm(pid, sum, cpage, startLimit, limit, order){
	var path = window.location.href.indexOf('.html')>0 ? '../../../' : '';
	if( limit>0 ){ loadComment(pid, sum, cpage, startLimit, 0, order); return; }
	$('#loadMoreBtn'+pid).css('pointer-events', 'none');
	$('#loadMoreBtn'+pid).html('正在載入 ...');
	$.post(path+'api.php', { 'action': 'loadMoreComm', 'pid': pid, 'page': cpage+1, 'startLimit': startLimit, 'order': order } , function( data ) {
		$.extend(window['comm'+pid], data);
		loadComment(pid, sum, cpage+1, startLimit, limit, order);
	}, "json").fail(function() {
		tailMsg('數據出錯，請重試', '', 0);
		loadComment(pid, sum);
	});
}

function loadComment(pid, sum, cpage, startLimit, limit, order){
	cpage = cpage || 0;
	startLimit = startLimit || 0;
	limit = limit || 0;
	order = order || 0;
	var counter = 0;
	var data = window['comm'+pid];
	var louId= $('#like'+pid).attr('authorid');
	$('#comm'+pid).empty();
	for(var key in data){
		var cid = parseInt(key.replace('c', ''));
		if(cpage==0 && data[key].l<=5){ startLimit++; }
		counter++;
		newTag   = ( counter==6 && order==1 ) ? '　　<span class="sred">最新</span>' : '';
		userFace = data[key].p ? '<img class="post_comm_face" src="'+data[key].p+'">' : '<div class="post_comm_face post_comm_face_svg"></div>';
		toUser = data[key].hasOwnProperty('ti') ? ' 回 <a href="javascript:" onclick="postreply(\'回 ('+data[key].tu+') 的點評\', '+pid+', '+data[key].ti+')" title="回覆此點評并短信通知">'+data[key].tu+'</a>' : '';
		likesClass = data[key].l ? 'class="s3"' : '';
		likes = '　　<a onclick="clickLike('+cid+', page, \'c\')" '+likesClass+' href="javascript:"  id="like'+cid+'">赞('+data[key].l+')</a>';
		commUserLink = '<a href="javascript:" onclick="postreply(\'回 ('+data[key].u+') 的點評\', '+pid+', '+data[key].i+', \'cont'+cid+'\')" title="回覆此點評并短信通知">'+data[key].u+'</a>';
		commAdmin = isAdmin ? '　<a href="masingle.php?action=delcomm&fid='+fid+'&cid='+cid+'">刪除</a>' : '';
		isAuthor = data[key].i==louId ? ' <span class="sgreen">层主</span>' : '';
		isAuthor = data[key].i==authorid ? ' <span class="sgreen">樓主</span>' : isAuthor;
		time = data[key].hasOwnProperty('d') ? loadCommDate(data[key].d) : data[key].t;
		$('#comm'+pid).append('<li class="fl">'+userFace+'</li><li style="overflow:hidden"><span style="min-width:100px;display:inline-block;">'+commUserLink+isAuthor+toUser+'</span>'+likes+newTag+'<br><div id="cont'+cid+'" class="post_cont">'+data[key].c.replace(/\\n/g, '<br>')+' <nobr class="f9 gray">'+time+commAdmin+'</nobr></div></li><div class="c"></div>');
		if( limit>0 && counter>=limit ){ break; }
	}
	collapseHTML = counter > 5 ? '　　<a href="javascript:" onclick="loadComment('+pid+', '+sum+', '+cpage+', '+startLimit+', 5, '+order+')">收起</a>　　' : '　　';
	replyHTML = '<a href="javascript:" onclick="$(\'#rp'+pid+'\').click()">我也说一句</a>';
	if(sum-counter > 0){
		newHTML = cpage==0 ? '　　<a href="javascript:" onclick="loadMoreComm('+pid+', '+sum+', 0, 0, 0, 1)">最新</a>' : '';
		$('#comm'+pid).append('<div style="padding-left:15px;"><a href="javascript:" id="loadMoreBtn'+pid+'" onclick="loadMoreComm('+pid+', '+sum+', '+cpage+', '+startLimit+', '+limit+', '+order+')">還有 '+(sum-counter)+' 條點評</a>'+newHTML+collapseHTML+replyHTML+'</div>');
	}else if(counter > 5){
		$('#comm'+pid).append('<div style="padding-left:15px;">沒有更多了'+collapseHTML+replyHTML+'</div>');
	}else{
		$('#comm'+pid).append('<div style="padding-left:15px;">'+replyHTML+'</div>');
	}
}

function loadCommDate(d){
	var t = new Date(d*1000-timeOffset);
	var ymd = getUTCYmd(t);
	return (getNewDateWithOffset().getUTCFullYear()!=t.getUTCFullYear() ? ymd : ymd.slice(-5)) + ' ' + ("0" + t.getUTCHours()).slice(-2) + ":" + ("0" + t.getUTCMinutes()).slice(-2);
}

function getUTCYmd(d){
	return d.getUTCFullYear() + '-' + ('0'+(d.getUTCMonth()+1)).slice(-2) + '-' + ('0'+d.getUTCDate()).slice(-2);
}

function getNewDateWithOffset(){
	return new Date(new Date().valueOf()-timeOffset);
}

document.addEventListener("DOMContentLoaded", function(event) {
	var today = getNewDateWithOffset();
	var yesterday = getNewDateWithOffset();
	yesterday.setDate(today.getUTCDate() - 1);
    var dataTs = document.querySelectorAll('[data-timestamp]');
    for (var i = 0; i < dataTs.length; i++) {
        var obj = dataTs[i];
        var timest = parseInt(obj.getAttribute('data-timestamp'));
		var fTime = new Date(timest*1000-timeOffset);
		var ymd = getUTCYmd(fTime);
		var hm  = ("0" + fTime.getUTCHours()).slice(-2) + ":" + ("0" + fTime.getUTCMinutes()).slice(-2);

		if(obj.getAttribute('data-timestamp').indexOf('s')>0){
			if(ymd == getUTCYmd(today)){
				obj.title = ymd + ' 今天 ' + hm;
			}else if(ymd == getUTCYmd(yesterday)){
				obj.title = ymd + ' 昨天 ' + hm;
			}else{
				obj.title = ymd + ' ' + hm;
			}
		}else{
			obj.innerHTML = (today.getFullYear()!=fTime.getFullYear() ? ymd : ymd.slice(-5)) + " " + hm;
		}
    }
});